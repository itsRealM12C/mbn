<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MBN Boot Logo Extractor</title>
<style>
  :root{color-scheme: dark}
  html,body{height:100%;margin:0;background:#0f1112;color:#eee;font-family:Inter, ui-sans-serif, system-ui, monospace}
  .wrap{box-sizing:border-box;max-width:720px;margin:14px auto;padding:12px;text-align:center}
  input[type=file]{display:block;margin:10px auto}
  canvas,img{border:1px solid #2a2d30;margin-top:10px;max-width:92%;height:auto;display:none}
  button{margin:10px;padding:8px 12px;background:#1f6feb;border:none;color:white;border-radius:6px;min-height:44px;cursor:pointer}
  pre{background:#0b0c0e;color:#cfe8ff;padding:10px;border-radius:6px;overflow:auto;text-align:left;max-height:220px}
  .row{display:flex;gap:8px;justify-content:center;flex-wrap:wrap}
</style>
</head>
<body>
  <div class="wrap">
    <h3 style="margin:6px 0 2px">MBN Boot Logo Extractor</h3>
    <div class="row">
      <input id="file" type="file" accept=".bin,*/*">
      <button id="download" disabled>Download BMP</button>
    </div>
    <canvas id="cv" ></canvas>
    <img id="preview" alt="logo preview">
    <pre id="log"></pre>
  </div>

  <script type="module" src="read.js"></script>
</body>
</html><body>

<h2>BM8 OEM Logo BMP Extractor</h2>

<input type="file" id="file" accept=".mbn">
<div class="info" id="info"></div>

<img id="preview">
<br>
<button id="download" disabled>Download BMP</button>

<script>
const fileInput = document.getElementById("file");
const info = document.getElementById("info");
const img = document.getElementById("preview");
const downloadBtn = document.getElementById("download");

let bmpBlob = null;

fileInput.addEventListener("change", () => {
    const file = fileInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = () => extractBMP(reader.result);
    reader.readAsArrayBuffer(file);
});

function extractBMP(buffer) {
    const bytes = new Uint8Array(buffer);

    let bmpOffset = -1;
    for (let i = 0; i < bytes.length - 1; i++) {
        if (bytes[i] === 0x42 && bytes[i + 1] === 0x4D) { // "BM"
            bmpOffset = i;
            break;
        }
    }

    if (bmpOffset === -1) {
        alert("BMP header not found in MBN.");
        return;
    }

    bmpBlob = new Blob([bytes.slice(bmpOffset)], { type: "image/bmp" });
    const url = URL.createObjectURL(bmpBlob);

    img.src = url;
    downloadBtn.disabled = false;

    info.innerHTML = `
        BMP header found at offset: <b>${bmpOffset}</b><br>
        Extracted size: <b>${bmpBlob.size}</b> bytes
    `;
}

downloadBtn.onclick = () => {
    if (!bmpBlob) return;
    const a = document.createElement("a");
    a.href = URL.createObjectURL(bmpBlob);
    a.download = "oemlogo_extracted.bmp";
    a.click();
};
</script>

</body>
</html>
